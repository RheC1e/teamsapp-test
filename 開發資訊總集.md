# RHEMA Teams 應用程式開發資訊總集

## 基本資訊

### 公司資訊
- **公司名稱**：航冠國際聯運有限公司 (RHEMA)
- **公司網域**：rhema.com.tw
- **公司帳號信箱**：ivan.chen@rhema.com.tw
- **個人私人信箱**：rhemaluis125@gmail.com（用於 Git/Vercel）

### Microsoft 365 方案
- **方案類型**：Microsoft 365 Business Basic
- **支援的帳戶類型**：僅我的組織 (My organization only)

### 組織架構
- 業務部門
- OP 部門
- 會計部門

---

## Git 與版本控制

### Git 帳號
- **GitHub 帳號**：RheC1e
- **GitHub URL**：https://github.com/RheC1e
- **SSH 連線**：已配置（使用 SSH 更新到 Git）

### 主要專案倉庫
1. **rhema-pwa-demo**：航冠國際聯運有限公司請款系統
2. **teams-sso-test**：Teams SSO 自動登入測試專案
   - 倉庫 URL：https://github.com/RheC1e/teams-sso-test

---

## Vercel 部署

### Vercel 帳號
- **Vercel URL**：https://vercel.com/ivans-projects-0e89bacc
- **登入帳號**：rhemaluis125@gmail.com

### 部署域名
- **測試域名**：teamsapp-test.vercel.app
- **應用程式 ID URI 前綴**：api://teamsapp-test.vercel.app

### 部署方式
- **方法一（推薦）**：使用 Vercel 網站 Import 功能
  1. 前往 https://vercel.com/new
  2. 選擇「Import Git Repository」
  3. 選擇 GitHub 倉庫：`RheC1e/teams-sso-test`
  4. 點擊「Deploy」

- **方法二**：使用 Vercel CLI
  ```bash
  vercel login
  vercel --prod
  ```

---

## Azure Active Directory (Microsoft Entra ID) 應用程式註冊

### 應用程式基本資訊
- **應用程式名稱**：RHEMA 請款系統 (RHEMA Reimbursement System)
- **應用程式 (Client) ID**：`33abd69a-d012-498a-bddb-8608cbf10c2d`
- **物件 (Object) ID**：`10e06464-823a-4262-a025-a54d564fce69`
- **目錄 (Tenant) ID**：`cd4e36bd-ac9a-4236-9f91-a6718b6b5e45`
- **支援的帳戶類型**：僅我的組織 (My organization only)

### 應用程式識別碼 URI
- **Application ID URI**：`api://teamsapp-test.vercel.app/33abd69a-d012-498a-bddb-8608cbf10c2d`

### API 權限（Microsoft Graph）
已配置且已授與管理員同意的權限：

1. **email** (已委派)
   - 描述：View users' email address
   - 需要系統管理員同意：否
   - 狀態：已授與

2. **GroupMember.Read.All** (已委派)
   - 描述：Read group memberships
   - 需要系統管理員同意：是
   - 狀態：已授與

3. **profile** (已委派)
   - 描述：View users' basic profile
   - 需要系統管理員同意：否
   - 狀態：已授與

4. **User.Read** (已委派)
   - 描述：Sign in and read user profile
   - 需要系統管理員同意：否
   - 狀態：已授與

5. **User.ReadBasic.All** (已委派)
   - 描述：Read all users' basic profiles
   - 需要系統管理員同意：否
   - 狀態：已授與

### 公開 API 設定

#### 定義的範圍 (Scopes)
- **範圍名稱**：`access_as_user`
- **完整範圍**：`api://teamsapp-test.vercel.app/33abd69a-d012-498a-bddb-8608cbf10c2d/access_as_user`
- **有權同意者**：管理員和使用者
- **狀態**：已啟用

#### 授權的用戶端應用程式
以下用戶端應用程式已授權，無需使用者同意即可呼叫 API：

1. **用戶端識別碼**：`1fec8e78-bce4-4aaf-ab1b-5451cc387264`（Teams 桌面版）
2. **用戶端識別碼**：`5e3ce6c0-2b1f-4285-8d4b-75ee78787346`（Teams 網頁版，如果需要的話）

### 重新導向 URI
- **類型**：SPA (Single-Page Application)
- **URI**：`https://teamsapp-test.vercel.app`
- **數量**：已配置

---

## 開發注意事項

### 驗證程式庫
- ⚠️ **重要**：自 2020 年 6 月 30 日起，Microsoft 不再為 ADAL 和 Azure AD Graph 新增功能
- ✅ **建議使用**：Microsoft Authentication Library (MSAL) 和 Microsoft Graph API
- ✅ **目前使用**：MSAL.js 進行 Teams SSO 整合

### Teams 應用程式開發
- **平台**：Microsoft Teams
- **部署方式**：Web 應用程式（免額外安裝）
- **認證方式**：Teams SSO（Single Sign-On）
- **快取處理**：使用版本號和 cache-busting 技術確保更新立即生效

---


## 自動化操作偏好

**重要原則**：以下操作應自動執行，無需用戶手動操作：
- ✅ Git 倉庫創建、初始化、提交、推送
- ✅ Vercel 部署（npm install、build、deploy）
- ✅ 圖標文件生成
- ✅ Teams 應用程式包壓縮
- ✅ 相關文件更新

---

## 聯絡資訊

### 開發者
- **姓名**：Ivan Chen
- **公司信箱**：ivan.chen@rhema.com.tw
- **個人信箱**：rhemaluis125@gmail.com

---

## 更新記錄

- **2025-01-07**：重新創建開發資訊總集文件
- **2025-01-07**：記錄自動化操作偏好
- **2025-01-XX**：初始文件建立
  - 記錄 Azure AD 應用程式註冊資訊
  - 記錄 API 權限配置
  - 記錄開發環境資訊

---

## 快速參考連結

- [Azure Portal - App Registrations](https://portal.azure.com/#view/Microsoft_AAD_RegisteredApps)
- [GitHub Profile](https://github.com/RheC1e)
- [GitHub 倉庫](https://github.com/RheC1e/teams-sso-test)
- [Vercel Dashboard](https://vercel.com/ivans-projects-0e89bacc)
- [Vercel 新增專案](https://vercel.com/new)
- [Microsoft Teams Developer Documentation](https://docs.microsoft.com/en-us/microsoftteams/platform/)
- [MSAL.js Documentation](https://github.com/AzureAD/microsoft-authentication-library-for-js)
